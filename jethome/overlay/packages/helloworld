#!/bin/bash
set -e # exit on failure

PROJECT_ARCH=all
PROJECT_VERSION=1.0-1 
PROJECT_NAME=helloworld
PACKAGE_NAME=${PROJECT_NAME}_${PROJECT_VERSION}_${PROJECT_ARCH}
mkdir -v $PACKAGE_NAME
mkdir -p -v $PACKAGE_NAME/usr/bin

echo -e "#!/bin/bash\necho Hello, World! Version: $PROJECT_VERSION" > $PACKAGE_NAME/usr/bin/helloworld
chmod -v +x $PACKAGE_NAME/usr/bin/helloworld
mkdir -p -v $PACKAGE_NAME/DEBIAN

# You can see package versions by command: apt-cache policy libc6
# You can see examples of Depends versions by command: dpkg -s bash

cat <<-EOF > $PACKAGE_NAME/DEBIAN/control
Package: $PROJECT_NAME
Version: $PROJECT_VERSION
Section: utils
Priority: optional
Architecture: $PROJECT_ARCH
Depends: bash (>= 4.4.18), libc6 (>= 2.27)
Maintainer: Example Examplov <example@example.com>
Description: Hello World
 Bash script which echo Hello, World! Version: $PROJECT_VERSION
 on terminal
EOF

dpkg -b "$PACKAGE_NAME" "${PACKAGE_NAME}.deb"
DEBIAN_FRONTEND=noninteractive apt -yqq --no-install-recommends install "./${PACKAGE_NAME}.deb"
mv -v "${PACKAGE_NAME}.deb" /tmp/overlay/debs
rm -rf "$PACKAGE_NAME"
